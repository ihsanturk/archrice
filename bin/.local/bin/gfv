#!/bin/bash

if [ -z $1 ]; then
   read -p "Link: " url
else
   url=$1
fi

if ! echo $url | grep -o 'https://' &>/dev/null; then
   if ! echo $url | grep -o 'github.com' &>/dev/null; then
      url=$(echo $url | awk -F/ '\
      BEGIN { OFS = "/" } {$2=$2"/master";printf "https://github.com/";print}')
   else
      url=$(echo $url | awk -F/ '\
      BEGIN { OFS = "/" } {$3=$3"/master";printf "https://";print}')
   fi
fi

url=$(echo $url | sed 's:blob/::g')
url=$(echo $url | sed 's/github\.com/raw.githubusercontent.com/g')
filename="$(echo $url | awk -F/ '{printf $NF}')"

mkdir -p /tmp/gfv/
curl -s -o /tmp/gfv/$filename $url &&
  $EDITOR /tmp/gfv/$filename || echo Error && exit 3
