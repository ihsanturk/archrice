#!/bin/bash

pgrep tureng-api 2>&1 >/dev/null || tureng-api &>/dev/null &
sleep 0.2

terms=$(echo $@ | sed 's/ /+/g')
url="localhost:8080/translate/$terms"

body=$(echo $(curl -s "$url" | jq '.response|.[]|.tr' | sed 5q |
sed 's/^"/~~/g; s/"$/++/g; s/~~//g;s/++/, /g')) &>/dev/null

if ! [ "$terms" = "" ]; then 
  dunstify  "$body" &>/dev/null ||
  osascript -e "\
  display notification \"$body\" with title \"Tureng\""
fi
