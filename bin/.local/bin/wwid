#!/bin/sh
# ============================================================================
# File:        wwid
# Description: wwid - what was i doing, remember what were you doing last night
# Author:      ihsan <ihsanl at pm dot me>
# License:     MIT license
# ============================================================================

# Vars
data=$HOME/.cache/wwid; [ -s $data ] || touch $data

# Args
unset item; unset when
while getopts :a:t: args; do
	case $args in
		(a) item="$OPTARG";;
		(t) when="$OPTARG";;
	esac
done

# Action
if [[ -z $item ]]; then
	if [[ -z $when ]]; then
		relativetime=`tail -n1 $data | grep -o '.*	'`
		echo "$relativetime	`tail -n1 $data`"
	else
		relativetime=`tail -r $data | sed "${when}q;d" | grep -o '.*	'`
		tail -r $data | sed "${when}q;d"
	fi
else
	echo "`date '+%s'`	$item" >> $data
fi
